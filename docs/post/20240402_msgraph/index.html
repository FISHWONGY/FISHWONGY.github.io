<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="/images/favicon.svg">
    
    <link rel="stylesheet" href="/scss/global.min.febf67ca94390198daa11693993dfeaabba2e6affbd40f291ab5081feac1bddd.css">
    
    <link rel="stylesheet" href="/css/prism.css" />
    <link href="https://fonts.googleapis.com/css?family=Merriweather&display=swap" rel="stylesheet">
    

 






	




<title>On Microsoft Graph with GCP &amp; Azure | Yu Wong</title>
<meta name="description" content="What is Microsoft Graph API 
Microsoft Graph exposes REST APIs and client libraries to access data on the following Microsoft cloud services:
1 - Microsoft 365 core services: Bookings, Calendar, Delve, Excel, Microsoft 365 compliance eDiscovery, Microsoft Search, OneDrive, OneNote, Outlook/Exchange, People (Outlook contacts), Planner, SharePoint, Teams, To Do, Viva Insights
2 - Enterprise Mobility &#43; Security services: Advanced Threat Analytics, Advanced Threat Protection, Microsoft Entra ID, Identity Manager, and Intune">
<meta property="og:title" content="On Microsoft Graph with GCP &amp; Azure | Yu Wong">
<meta property="og:site_name" content="Yu Wong">
<meta property="og:description" content="What is Microsoft Graph API 
Microsoft Graph exposes REST APIs and client libraries to access data on the following Microsoft cloud services:
1 - Microsoft 365 core services: Bookings, Calendar, Delve, Excel, Microsoft 365 compliance eDiscovery, Microsoft Search, OneDrive, OneNote, Outlook/Exchange, People (Outlook contacts), Planner, SharePoint, Teams, To Do, Viva Insights
2 - Enterprise Mobility &#43; Security services: Advanced Threat Analytics, Advanced Threat Protection, Microsoft Entra ID, Identity Manager, and Intune">
<meta property="og:url" content="https://FISHWONGY.github.io/post/20240402_msgraph/">
<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:image" content='https://FISHWONGY.github.io/images/on_msgraph/aca-cr-cover.png'><meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="On Microsoft Graph with GCP &amp; Azure | Yu Wong">

	<link rel="canonical" href="https://FISHWONGY.github.io/post/20240402_msgraph/">


	<meta name="twitter:site" content="@https://twitter.com/fishwongxd">
	<meta name="twitter:creator" content="@https://twitter.com/fishwongxd">

	<meta name="twitter:description" content="What is Microsoft Graph API 
Microsoft Graph exposes REST APIs and client libraries to access data on the following Microsoft cloud services:
1 - Microsoft 365 core services: Bookings, Calendar, Delve, Excel, Microsoft 365 compliance eDiscovery, Microsoft Search, OneDrive, OneNote, Outlook/Exchange, People (Outlook contacts), Planner, SharePoint, Teams, To Do, Viva Insights
2 - Enterprise Mobility &#43; Security services: Advanced Threat Analytics, Advanced Threat Protection, Microsoft Entra ID, Identity Manager, and Intune">
<meta name="twitter:image" content="https://FISHWONGY.github.io/images/on_msgraph/aca-cr-cover.png">
<meta property="article:published_time" content="2024-04-02T00:00:00&#43;00:00">
	<meta property="article:updated_time" content="2024-04-02T00:00:00&#43;00:00">



    </head>


<body class="line-numbers">

    
    <script src="/js/initColors.js"></script>

    <div class="layout-styled">

        <Section class="section">
  <div class="nav-container">
    <a class="logo-link" href="/">
      <svg width="368.56" height="60" viewBox="0 0 368.56 60" xmlns="http://www.w3.org/2000/svg"><g id="svgGroup" stroke-linecap="round" fill-rule="evenodd" font-size="9pt" stroke="#898989" stroke-width="0.25mm" fill="#898989" style="stroke:#898989;stroke-width:0.25mm;fill:#898989"><path d="M 177.36 1.2 L 189.28 1.2 Q 190.181 1.2 190.787 1.439 A 2.005 2.005 0 0 1 191.48 1.88 A 2.021 2.021 0 0 1 191.933 2.603 Q 192.054 2.921 192.11 3.318 A 5.414 5.414 0 0 1 192.16 4.08 L 192.16 35.12 Q 192.16 37.68 191.96 39.88 Q 191.808 41.554 191.17 43.667 A 32.44 32.44 0 0 1 190.72 45.04 L 186.72 55.92 A 6.092 6.092 0 0 1 186.118 57.218 A 5.19 5.19 0 0 1 185.56 57.96 A 2.509 2.509 0 0 1 183.945 58.775 A 3.527 3.527 0 0 1 183.52 58.8 L 172.88 58.8 A 5.05 5.05 0 0 1 171.339 58.57 A 4.554 4.554 0 0 1 170.56 58.24 A 2.632 2.632 0 0 1 169.311 56.764 A 3.661 3.661 0 0 1 169.2 56.4 L 165.52 43.36 A 4.204 4.204 0 0 0 165.384 42.972 Q 165.184 42.486 164.92 42.28 A 1.326 1.326 0 0 0 164.095 42 A 1.635 1.635 0 0 0 164.08 42 L 163.36 42 A 1.384 1.384 0 0 0 162.821 42.103 A 1.314 1.314 0 0 0 162.52 42.28 A 1.131 1.131 0 0 0 162.297 42.52 Q 162.081 42.823 161.92 43.36 L 158.16 56.4 A 3.645 3.645 0 0 1 157.808 57.276 A 2.761 2.761 0 0 1 156.96 58.2 Q 156.08 58.8 154.8 58.8 L 144.24 58.8 A 3.413 3.413 0 0 1 142.931 58.554 A 3.212 3.212 0 0 1 142.04 58 A 4.323 4.323 0 0 1 140.865 56.327 A 5.332 5.332 0 0 1 140.72 55.92 L 136.72 44.88 Q 135.68 41.92 135.48 39.72 Q 135.28 37.52 135.28 34.96 L 135.28 4.08 Q 135.28 3.179 135.519 2.573 A 2.005 2.005 0 0 1 135.96 1.88 A 2.021 2.021 0 0 1 136.683 1.427 Q 137.001 1.307 137.398 1.25 A 5.414 5.414 0 0 1 138.16 1.2 L 150.48 1.2 Q 151.381 1.2 151.987 1.439 A 2.005 2.005 0 0 1 152.68 1.88 A 2.021 2.021 0 0 1 153.133 2.603 Q 153.254 2.921 153.31 3.318 A 5.414 5.414 0 0 1 153.36 4.08 L 153.36 33.52 L 158 23.44 Q 158.565 22.24 159.442 21.662 A 3.145 3.145 0 0 1 159.68 21.52 A 4.453 4.453 0 0 1 160.88 21.092 Q 161.406 20.981 162.013 20.963 A 7.962 7.962 0 0 1 162.24 20.96 L 165.6 20.96 A 6.846 6.846 0 0 1 166.746 21.051 Q 167.389 21.16 167.92 21.401 A 3.968 3.968 0 0 1 168.16 21.52 A 3.43 3.43 0 0 1 169.204 22.403 Q 169.516 22.79 169.769 23.294 A 6.241 6.241 0 0 1 169.84 23.44 L 174.48 33.52 L 174.48 4.08 Q 174.48 3.179 174.719 2.573 A 2.005 2.005 0 0 1 175.16 1.88 A 2.021 2.021 0 0 1 175.883 1.427 Q 176.201 1.307 176.598 1.25 A 5.414 5.414 0 0 1 177.36 1.2 Z M 276.32 58.8 L 264.32 58.8 Q 263.419 58.8 262.813 58.561 A 2.005 2.005 0 0 1 262.12 58.12 A 2.021 2.021 0 0 1 261.667 57.397 Q 261.547 57.079 261.49 56.682 A 5.414 5.414 0 0 1 261.44 55.92 L 261.44 4.08 Q 261.44 3.179 261.679 2.573 A 2.005 2.005 0 0 1 262.12 1.88 A 2.021 2.021 0 0 1 262.843 1.427 Q 263.161 1.307 263.558 1.25 A 5.414 5.414 0 0 1 264.32 1.2 L 272.64 1.2 A 8.086 8.086 0 0 1 273.802 1.279 Q 274.443 1.373 274.984 1.575 A 4.672 4.672 0 0 1 275.24 1.68 Q 276.32 2.16 277.36 3.36 L 292.88 21.12 L 292.88 4.08 Q 292.88 3.179 293.119 2.573 A 2.005 2.005 0 0 1 293.56 1.88 A 2.021 2.021 0 0 1 294.283 1.427 Q 294.601 1.307 294.998 1.25 A 5.414 5.414 0 0 1 295.76 1.2 L 307.76 1.2 Q 308.661 1.2 309.267 1.439 A 2.005 2.005 0 0 1 309.96 1.88 A 2.021 2.021 0 0 1 310.413 2.603 Q 310.534 2.921 310.59 3.318 A 5.414 5.414 0 0 1 310.64 4.08 L 310.64 55.92 Q 310.64 56.821 310.401 57.427 A 2.005 2.005 0 0 1 309.96 58.12 A 2.021 2.021 0 0 1 309.237 58.573 Q 308.919 58.694 308.522 58.75 A 5.414 5.414 0 0 1 307.76 58.8 L 295.76 58.8 Q 294.859 58.8 294.253 58.561 A 2.005 2.005 0 0 1 293.56 58.12 A 2.021 2.021 0 0 1 293.107 57.397 Q 292.987 57.079 292.93 56.682 A 5.414 5.414 0 0 1 292.88 55.92 L 292.88 46.08 L 279.2 29.52 L 279.2 55.92 Q 279.2 56.821 278.961 57.427 A 2.005 2.005 0 0 1 278.52 58.12 A 2.021 2.021 0 0 1 277.797 58.573 Q 277.479 58.694 277.082 58.75 A 5.414 5.414 0 0 1 276.32 58.8 Z M 107.36 4.08 L 107.36 43.68 A 21.686 21.686 0 0 1 107.028 47.553 A 17.483 17.483 0 0 1 106.28 50.36 A 10.921 10.921 0 0 1 103.183 54.866 A 13.434 13.434 0 0 1 102.44 55.48 A 14.98 14.98 0 0 1 99.861 57.051 Q 97.73 58.088 94.88 58.8 A 34.841 34.841 0 0 1 90.954 59.526 Q 88.909 59.792 86.534 59.909 A 79.42 79.42 0 0 1 82.64 60 A 76.425 76.425 0 0 1 77.837 59.858 Q 75.493 59.71 73.488 59.408 A 33.183 33.183 0 0 1 70.4 58.8 Q 65.6 57.6 62.84 55.48 A 11.957 11.957 0 0 1 60.238 52.776 A 10.566 10.566 0 0 1 59 50.36 A 18.189 18.189 0 0 1 58.051 46.157 A 22.845 22.845 0 0 1 57.92 43.68 L 57.92 4.08 Q 57.92 3.179 58.159 2.573 A 2.005 2.005 0 0 1 58.6 1.88 A 2.021 2.021 0 0 1 59.323 1.427 Q 59.641 1.307 60.038 1.25 A 5.414 5.414 0 0 1 60.8 1.2 L 73.36 1.2 Q 74.261 1.2 74.867 1.439 A 2.005 2.005 0 0 1 75.56 1.88 A 2.021 2.021 0 0 1 76.013 2.603 Q 76.134 2.921 76.19 3.318 A 5.414 5.414 0 0 1 76.24 4.08 L 76.24 40.56 A 3.441 3.441 0 0 0 77.295 43.103 A 4.25 4.25 0 0 0 77.44 43.24 Q 78.578 44.264 82.375 44.317 A 30.299 30.299 0 0 0 82.8 44.32 A 26.054 26.054 0 0 0 84.51 44.268 Q 87.303 44.084 88.24 43.24 A 3.577 3.577 0 0 0 89.185 41.925 A 3.589 3.589 0 0 0 89.44 40.56 L 89.44 4.08 Q 89.44 3.179 89.679 2.573 A 2.005 2.005 0 0 1 90.12 1.88 A 2.021 2.021 0 0 1 90.843 1.427 Q 91.161 1.307 91.558 1.25 A 5.414 5.414 0 0 1 92.32 1.2 L 104.48 1.2 Q 105.381 1.2 105.987 1.439 A 2.005 2.005 0 0 1 106.68 1.88 A 2.021 2.021 0 0 1 107.133 2.603 Q 107.254 2.921 107.31 3.318 A 5.414 5.414 0 0 1 107.36 4.08 Z M 365.68 58.8 L 340.48 58.8 A 40.094 40.094 0 0 1 335.263 58.484 Q 329.119 57.675 325.64 54.8 Q 321.23 51.156 320.838 43.925 A 26.699 26.699 0 0 1 320.8 42.48 L 320.8 17.52 A 22.613 22.613 0 0 1 321.261 12.797 Q 321.872 9.938 323.294 7.802 A 11.943 11.943 0 0 1 325.64 5.2 Q 330.48 1.2 340.48 1.2 L 360.48 1.2 Q 361.381 1.2 361.987 1.439 A 2.005 2.005 0 0 1 362.68 1.88 A 2.021 2.021 0 0 1 363.133 2.603 Q 363.254 2.921 363.31 3.318 A 5.414 5.414 0 0 1 363.36 4.08 L 363.36 13.76 Q 363.36 14.661 363.121 15.267 A 2.005 2.005 0 0 1 362.68 15.96 A 2.021 2.021 0 0 1 361.957 16.413 Q 361.639 16.534 361.242 16.59 A 5.414 5.414 0 0 1 360.48 16.64 L 343.84 16.64 Q 341.36 16.64 340.16 17.64 Q 339.015 18.595 338.963 20.461 A 6.444 6.444 0 0 0 338.96 20.64 L 338.96 39.76 Q 338.96 41.011 339.32 41.855 A 2.852 2.852 0 0 0 339.88 42.72 Q 340.664 43.538 342.117 43.659 A 6.316 6.316 0 0 0 342.64 43.68 L 350.4 43.68 L 350.4 31.2 Q 350.4 30.299 350.639 29.693 A 2.005 2.005 0 0 1 351.08 29 A 2.021 2.021 0 0 1 351.803 28.547 Q 352.121 28.427 352.518 28.37 A 5.414 5.414 0 0 1 353.28 28.32 L 365.68 28.32 Q 366.581 28.32 367.187 28.559 A 2.005 2.005 0 0 1 367.88 29 A 2.021 2.021 0 0 1 368.333 29.723 Q 368.454 30.041 368.51 30.438 A 5.414 5.414 0 0 1 368.56 31.2 L 368.56 55.92 Q 368.56 56.821 368.321 57.427 A 2.005 2.005 0 0 1 367.88 58.12 A 2.021 2.021 0 0 1 367.157 58.573 Q 366.839 58.694 366.442 58.75 A 5.414 5.414 0 0 1 365.68 58.8 Z M 31.12 58.8 L 18.16 58.8 Q 17.259 58.8 16.653 58.561 A 2.005 2.005 0 0 1 15.96 58.12 A 2.021 2.021 0 0 1 15.507 57.397 Q 15.387 57.079 15.33 56.682 A 5.414 5.414 0 0 1 15.28 55.92 L 15.28 45.68 L 3.04 29.28 A 25.522 25.522 0 0 1 2.011 27.793 Q 1.017 26.231 0.603 24.97 A 7.662 7.662 0 0 1 0.6 24.96 A 9.289 9.289 0 0 1 0.297 23.705 Q 0.066 22.401 0.015 20.547 A 40.042 40.042 0 0 1 0 19.44 L 0 4.08 Q 0 3.179 0.239 2.573 A 2.005 2.005 0 0 1 0.68 1.88 A 2.021 2.021 0 0 1 1.403 1.427 Q 1.721 1.307 2.118 1.25 A 5.414 5.414 0 0 1 2.88 1.2 L 15.2 1.2 Q 16.101 1.2 16.707 1.439 A 2.005 2.005 0 0 1 17.4 1.88 A 2.021 2.021 0 0 1 17.853 2.603 Q 17.974 2.921 18.03 3.318 A 5.414 5.414 0 0 1 18.08 4.08 L 18.08 17.2 A 17.861 17.861 0 0 0 18.123 18.418 A 20.731 20.731 0 0 0 18.16 18.88 A 3.338 3.338 0 0 0 18.607 20.257 A 4.099 4.099 0 0 0 18.8 20.56 L 22.48 26.32 A 4.841 4.841 0 0 0 22.747 26.75 Q 23.024 27.145 23.32 27.36 A 1.65 1.65 0 0 0 24.02 27.649 A 2.228 2.228 0 0 0 24.4 27.68 L 25.2 27.68 A 2.123 2.123 0 0 0 25.717 27.62 A 1.614 1.614 0 0 0 26.28 27.36 A 2.131 2.131 0 0 0 26.604 27.064 Q 26.753 26.899 26.897 26.685 A 5.005 5.005 0 0 0 27.12 26.32 L 30.8 20.56 Q 31.36 19.76 31.44 18.88 A 19.38 19.38 0 0 0 31.514 17.656 A 16.69 16.69 0 0 0 31.52 17.2 L 31.52 4.08 Q 31.52 3.179 31.759 2.573 A 2.005 2.005 0 0 1 32.2 1.88 A 2.021 2.021 0 0 1 32.923 1.427 Q 33.241 1.307 33.638 1.25 A 5.414 5.414 0 0 1 34.4 1.2 L 46.32 1.2 Q 47.221 1.2 47.827 1.439 A 2.005 2.005 0 0 1 48.52 1.88 A 2.021 2.021 0 0 1 48.973 2.603 Q 49.094 2.921 49.15 3.318 A 5.414 5.414 0 0 1 49.2 4.08 L 49.2 19.44 Q 49.2 22.552 48.742 24.348 A 7.509 7.509 0 0 1 48.56 24.96 A 11.537 11.537 0 0 1 47.988 26.301 Q 47.651 26.977 47.194 27.722 A 28.03 28.03 0 0 1 46.16 29.28 L 34 45.76 L 34 55.92 Q 34 56.821 33.761 57.427 A 2.005 2.005 0 0 1 33.32 58.12 A 2.021 2.021 0 0 1 32.597 58.573 Q 32.279 58.694 31.882 58.75 A 5.414 5.414 0 0 1 31.12 58.8 Z M 251.28 16.4 L 251.28 43.68 A 21.686 21.686 0 0 1 250.948 47.553 A 17.483 17.483 0 0 1 250.2 50.36 A 10.921 10.921 0 0 1 247.103 54.866 A 13.434 13.434 0 0 1 246.36 55.48 A 14.88 14.88 0 0 1 243.774 57.051 Q 242.437 57.699 240.812 58.22 A 31.607 31.607 0 0 1 238.76 58.8 A 35.559 35.559 0 0 1 234.764 59.531 Q 231.13 60 226.48 60 A 76.23 76.23 0 0 1 221.463 59.845 Q 219.114 59.69 217.097 59.379 A 34.086 34.086 0 0 1 214.16 58.8 Q 209.28 57.6 206.52 55.48 A 11.957 11.957 0 0 1 203.918 52.776 A 10.566 10.566 0 0 1 202.68 50.36 A 18.189 18.189 0 0 1 201.731 46.157 A 22.845 22.845 0 0 1 201.6 43.68 L 201.6 16.4 A 21.686 21.686 0 0 1 201.932 12.527 A 17.483 17.483 0 0 1 202.68 9.72 Q 203.76 6.72 206.52 4.56 A 14.579 14.579 0 0 1 209.112 2.964 Q 210.456 2.307 212.092 1.782 A 31.062 31.062 0 0 1 214.16 1.2 A 36.194 36.194 0 0 1 218.18 0.469 Q 220.233 0.205 222.603 0.09 A 79.867 79.867 0 0 1 226.48 0 A 76.654 76.654 0 0 1 231.288 0.142 Q 233.671 0.292 235.709 0.601 A 33.704 33.704 0 0 1 238.76 1.2 A 28.557 28.557 0 0 1 241.97 2.187 Q 243.527 2.774 244.783 3.501 A 13.633 13.633 0 0 1 246.36 4.56 A 12.302 12.302 0 0 1 248.919 7.235 A 10.723 10.723 0 0 1 250.2 9.72 A 18.189 18.189 0 0 1 251.15 13.924 A 22.845 22.845 0 0 1 251.28 16.4 Z M 219.76 19.28 L 219.76 40.8 A 3.441 3.441 0 0 0 220.815 43.343 A 4.25 4.25 0 0 0 220.96 43.48 A 2.793 2.793 0 0 0 221.818 43.978 Q 223.164 44.504 225.882 44.555 A 31.967 31.967 0 0 0 226.48 44.56 A 26.994 26.994 0 0 0 228.221 44.508 Q 230.759 44.344 231.778 43.653 A 2.053 2.053 0 0 0 232 43.48 A 3.577 3.577 0 0 0 232.945 42.165 A 3.589 3.589 0 0 0 233.2 40.8 L 233.2 19.28 A 3.34 3.34 0 0 0 232.145 16.817 A 4.459 4.459 0 0 0 232 16.68 A 2.793 2.793 0 0 0 231.142 16.183 Q 229.797 15.656 227.078 15.606 A 31.967 31.967 0 0 0 226.48 15.6 A 26.994 26.994 0 0 0 224.739 15.652 Q 222.201 15.817 221.182 16.508 A 2.053 2.053 0 0 0 220.96 16.68 A 3.757 3.757 0 0 0 220.14 17.709 A 3.3 3.3 0 0 0 219.76 19.28 Z" vector-effect="non-scaling-stroke"/></g></svg>
      <span class="header-hidden">Navigate back to the homepage</span>
    </a>
    <div class="nav-controls">
      <button id="copyButton" class="icon-wrapper">
        <svg
    class="icon-image"
    width="24"
    height="20"
    viewBox="0 0 24 20"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    >
    <path
      fillRule="evenodd"
      clipRule="evenodd"
      d="M2 5C2 3.34328 3.34328 2 5 2H14C15.6567 2 17 3.34328 17 5V9C17 10.6567 15.6567 12 14 12H10C9.44771 12 9 12.4477 9 13C9 13.5523 9.44771 14 10 14H14C16.7613 14 19 11.7613 19 9V5C19 2.23872 16.7613 0 14 0H5C2.23872 0 0 2.23872 0 5V9C0 10.4938 0.656313 11.8361 1.6935 12.7509C2.10768 13.1163 2.73961 13.0767 3.10494 12.6625C3.47028 12.2483 3.43068 11.6164 3.0165 11.2511C2.39169 10.6999 2 9.89621 2 9V5ZM7 11C7 9.34328 8.34328 8 10 8H14C14.5523 8 15 7.55228 15 7C15 6.44772 14.5523 6 14 6H10C7.23872 6 5 8.23872 5 11V15C5 17.7613 7.23872 20 10 20H19C21.7613 20 24 17.7613 24 15V11C24 9.50621 23.3437 8.16393 22.3065 7.24906C21.8923 6.88372 21.2604 6.92332 20.8951 7.3375C20.5297 7.75168 20.5693 8.38361 20.9835 8.74894C21.6083 9.30007 22 10.1038 22 11V15C22 16.6567 20.6567 18 19 18H10C8.34328 18 7 16.6567 7 15V11Z"
      fill="#000"
    />
</svg>
        <div id="toolTip" class="tool-tip " >
            copied
        </div>
        <input id="copyText" style="opacity: 0;" type="text" class="tool-tip " />
      </button>

      <button id="themeColorButton" class="icon-wrapper"> 
        <div id="sunRays" class="sun-rays"></div>
        <div id="moonOrSun" class="moon-or-sun"></div>
        <div id="moonMask" class="moon-mask"></div>
      </button>
    </div>
</div>
</Section>


<script src="/js/toggleLogos.js"></script>


<script src="/js/toggleColors.js"></script>


<script src="/js/copyUrl.js"></script>

        

<section class="section narrow">

    <section id="articleHero" class="section narrow">
    <div class="article-hero">
        <header class="article-header">
            <h1 class="article-hero-heading">On Microsoft Graph with GCP &amp; Azure</h1>
            <div class="article-hero-subtitle">
                <div class="article-meta">
                    


    
            <a href="/authors/hugo-authors/" class="article-author-link">
                
                    <div class="article-author-avatar">
                        <img src="/images/profile-02.jpg" />
                    </div>
                
                
                <strong>Yu Wong</strong>
                
                <span class="hide-on-mobile">,&nbsp;</span>
            </a>
    



<script src="/js/collapseAuthors.js"></script>
                    April 2, 2024
                    • 8 min read
                </div>
            </div>
        </header>
        
        <div class="article-hero-image" id="ArticleImage__Hero">
            <img src="/images/on_msgraph/aca-cr-cover.png">
        </div>
        
    </div>
</section>


    <aside id="progressBar" class="aside-container">
    <div class="aside-align">
      <div>
        <div class="overlap-container">
        </div>
      </div>
    </div>

    <div class="progress-container" tabIndex={-1}>
        <div class="track-line" aria-hidden="true">
            <div id="progressIndicator" class="progress-line"></div>
        </div>
    </div>
</aside>


    <article  id="articleContent" class="post-content" style="position:relative;">
        <p><u><b>
<p style="font-size:20pt ">
What is Microsoft Graph API
</b></u></p>
<p>Microsoft Graph exposes REST APIs and client libraries to access data on the following Microsoft cloud services:</p>
<p>1 - Microsoft 365 core services: Bookings, Calendar, Delve, Excel, Microsoft 365 compliance eDiscovery, Microsoft Search, OneDrive, OneNote, Outlook/Exchange, People (Outlook contacts), Planner, SharePoint, Teams, To Do, Viva Insights</p>
<p>2 - Enterprise Mobility + Security services: Advanced Threat Analytics, Advanced Threat Protection, Microsoft Entra ID, Identity Manager, and Intune</p>
<p>3 - Windows services: activities, devices, notifications, Universal Print</p>
<p>4 - Dynamics 365 Business Central services</p>
<p>Furthermore, Microsoft Graph API also has subscription services that allows a client app to receive change notifications about changes to data in Microsoft Graph.</p>
<p>For more information on Microsoft Graph API, please refer to the <a href="https://learn.microsoft.com/en-us/graph/overview">official documentation</a>.</p>
<p align="center">
<img alt = 'png' src='/images/on_msgraph/microsoft-graph.png'/>
</p>
<p><br /></p>
<p><u><b>
<p style="font-size:20pt ">
Working with Graph API
</b></u></p>
<p>As an example, we will be working with the Microsoft Graph API to create a webhook application that listens to changes in the <a href="https://learn.microsoft.com/en-us/graph/api/resources/event?view=graph-rest-1.0">user&rsquo;s events</a>.</p>
<p>To create subscription, we can either use Microsoft&rsquo;s msgaraph library or use the requests library.</p>
<p>1 - Microsoft&rsquo;s <a href="https://learn.microsoft.com/en-us/graph/api/subscription-post-subscriptions?view=graph-rest-1.0&amp;tabs=python">msgaraph library</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> msgraph <span style="color:#f92672">import</span> GraphServiceClient
<span style="color:#f92672">from</span> msgraph.generated.models.subscription <span style="color:#f92672">import</span> Subscription
<span style="color:#f92672">import</span> arrow

graph_client <span style="color:#f92672">=</span> GraphServiceClient(credentials, scopes)

request_body <span style="color:#f92672">=</span> Subscription(
	change_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;created,updated,deleted&#34;</span>,
	notification_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://webhook.azurewebsites.net/events&#34;</span>,
	resource <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;/users/{member_id}/events&#34;</span>,
	expiration_date_time <span style="color:#f92672">=</span> arrow<span style="color:#f92672">.</span>utcnow()<span style="color:#f92672">.</span>shift(hours<span style="color:#f92672">=+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>format(<span style="color:#e6db74">&#34;YYYY-MM-DDTHH:mm:ssZZ&#34;</span>),
	client_state <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;secretClientValue&#34;</span>,
	latest_supported_tls_version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;v1_2&#34;</span>,
)

result <span style="color:#f92672">=</span> await graph_client<span style="color:#f92672">.</span>subscriptions<span style="color:#f92672">.</span>post(request_body)
</code></pre></div><p>2 - Using the requests library, in settings.py, it stores the client_id, client_secret, tenant_id, scope, and graph_url.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> arrow
<span style="color:#f92672">import</span> requests
<span style="color:#f92672">from</span> azure.identity <span style="color:#f92672">import</span> ClientSecretCredential
<span style="color:#f92672">from</span> settings <span style="color:#f92672">import</span> CLIENT_ID, CLIENT_SECRET, TENANT_ID, SCOPE, GRAPH_URL

CLIENT <span style="color:#f92672">=</span> ClientSecretCredential(
    tenant_id<span style="color:#f92672">=</span>TENANT_ID, client_id<span style="color:#f92672">=</span>CLIENT_ID, client_secret<span style="color:#f92672">=</span>CLIENT_SECRET
)
token <span style="color:#f92672">=</span> CLIENT<span style="color:#f92672">.</span>get_token(SCOPE)<span style="color:#f92672">.</span>token

headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;Authorization&#34;</span>: f<span style="color:#e6db74">&#34;Bearer {token}&#34;</span>, <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/json&#34;</span>}

subscription_data <span style="color:#f92672">=</span> {
        <span style="color:#e6db74">&#34;changeType&#34;</span>: <span style="color:#e6db74">&#34;created,updated,deleted&#34;</span>,
        <span style="color:#e6db74">&#34;notificationUrl&#34;</span>: <span style="color:#e6db74">&#34;https://webhook.azurewebsites.net/events&#34;</span>,
        <span style="color:#e6db74">&#34;resource&#34;</span>: f<span style="color:#e6db74">&#34;/users/{member_id}/events&#34;</span>,
        <span style="color:#e6db74">&#34;expirationDateTime&#34;</span>: arrow<span style="color:#f92672">.</span>utcnow()<span style="color:#f92672">.</span>shift(hours<span style="color:#f92672">=+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>format(<span style="color:#e6db74">&#34;YYYY-MM-DDTHH:mm:ssZZ&#34;</span>),
        <span style="color:#e6db74">&#34;clientState&#34;</span>: <span style="color:#e6db74">&#34;secretClientValue&#34;</span>,
    }

re <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(
        f<span style="color:#e6db74">&#34;{GRAPH_URL}/subscriptions&#34;</span>,
        headers<span style="color:#f92672">=</span>headers,
        json<span style="color:#f92672">=</span>subscription_data,
    )
</code></pre></div><p>We can see on both of the above examples, there is a parameter called notificationUrl. This is the URL that Microsoft Graph will send the notification to, and we can obtain it either by setting up GCP cloud run or Azure container apps.
We will dive deeper in the next section.</p>
<p><u><b>
<p style="font-size:20pt ">
Building the application on GCP
</b></u></p>
<p align="center">
<img alt = 'png' src='/images/on_msgraph/gcp-cloud-run-flow.png'/>
</p>
<p>The setup of the application, on a high level, will be similar to our <a href="https://fishwongy.github.io/post/20240401_jiraoauth/">last blog post on working with cloud run</a>.</p>
<p>The below is the python application structure.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-md" data-lang="md">├── Dockerfile
├── README.md
├── app
│   ├── helpers
│   ├── main.py
│   └── settings.py
├── deploy
│   └── production
│       └── service.yaml
├── docker-compose.yml
├── poetry.lock
├── pyproject.toml
└── skaffold.yaml
</code></pre></div><p>deploy/production/service.yaml</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">serving.knative.dev/v1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Service</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">my-app</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">template</span>:
    <span style="color:#f92672">spec</span>:
      <span style="color:#f92672">serviceAccountName</span>: <span style="color:#ae81ff">svc@gcp-prj-123.iam.gserviceaccount.com</span>
      <span style="color:#f92672">containers</span>:
      - <span style="color:#f92672">image</span>: <span style="color:#ae81ff">us-central1-docker.pkg.dev/gcp-prj-123/repo/my-app</span>
        <span style="color:#f92672">ports</span>:
        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">http1</span>
          <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">80</span>
        <span style="color:#f92672">env</span>:
        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">GCP_PROJECT_ID</span>
          <span style="color:#f92672">value</span>: <span style="color:#ae81ff">gcp-prj-123</span>
        - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">ENV</span>
          <span style="color:#f92672">value</span>: <span style="color:#ae81ff">prod</span>
</code></pre></div><p>Dockerfile</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-dockerfile" data-lang="dockerfile"><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> python:3.11-slim</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">WORKDIR</span><span style="color:#e6db74"> /usr/src/app</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> PYTHONUNBUFFERED<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    PYTHONDONTWRITEBYTECODE<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    POETRY_VERSION<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>.7.1 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    USERNAME<span style="color:#f92672">=</span>nonroot<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> adduser $USERNAME<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">USER</span><span style="color:#e6db74"> $USERNAME</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> HOME<span style="color:#f92672">=</span>/home/$USERNAME<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.local/bin:</span>$PATH<span style="color:#e6db74">&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> pip install pipx<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> pipx install poetry<span style="color:#f92672">==</span><span style="color:#e6db74">${</span>POETRY_VERSION<span style="color:#e6db74">}</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> ./poetry.lock pyproject.toml /usr/src/app/<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> poetry install -nv --no-root<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> creds creds<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> app .<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">CMD</span> [<span style="color:#e6db74">&#34;poetry&#34;</span>, <span style="color:#e6db74">&#34;run&#34;</span>, <span style="color:#e6db74">&#34;uvicorn&#34;</span>, <span style="color:#e6db74">&#34;main:app&#34;</span>, <span style="color:#e6db74">&#34;--host&#34;</span>, <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>, <span style="color:#e6db74">&#34;--port&#34;</span>, <span style="color:#e6db74">&#34;80&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>pyproject.toml</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">[<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">poetry</span>]
<span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;my-app&#34;</span>
<span style="color:#a6e22e">version</span> = <span style="color:#e6db74">&#34;0.1.0&#34;</span>
<span style="color:#a6e22e">description</span> = <span style="color:#e6db74">&#34;&#34;</span>
<span style="color:#a6e22e">authors</span> = [<span style="color:#e6db74">&#34; &#34;</span>]
<span style="color:#a6e22e">readme</span> = <span style="color:#e6db74">&#34;README.md&#34;</span>

[<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">poetry</span>.<span style="color:#a6e22e">dependencies</span>]
<span style="color:#a6e22e">python</span> = <span style="color:#e6db74">&#34;^3.9&#34;</span>
<span style="color:#a6e22e">httpx</span> = <span style="color:#e6db74">&#34;^0.27.0&#34;</span>
<span style="color:#a6e22e">fastapi</span> = <span style="color:#e6db74">&#34;^0.104.1&#34;</span>
<span style="color:#a6e22e">uvicorn</span> = <span style="color:#e6db74">&#34;^0.24.0.post1&#34;</span>

<span style="color:#a6e22e">pandas</span> = <span style="color:#e6db74">&#34;^2.0.0&#34;</span>
<span style="color:#a6e22e">python</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">dateutil</span> = <span style="color:#e6db74">&#34;^2.8.2&#34;</span>
<span style="color:#a6e22e">pydantic</span> = <span style="color:#e6db74">&#34;^1.10.7&#34;</span>
<span style="color:#a6e22e">tenacity</span> = <span style="color:#e6db74">&#34;^8.2.3&#34;</span>
<span style="color:#a6e22e">confluent</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">kafka</span> = <span style="color:#e6db74">&#34;^2.3.0&#34;</span>

<span style="color:#a6e22e">google</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">cloud</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">logging</span> = <span style="color:#e6db74">&#34;^3.8.0&#34;</span>
<span style="color:#a6e22e">google</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">cloud</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">secret</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">manager</span> = <span style="color:#e6db74">&#34;^2.16.4&#34;</span>

<span style="color:#a6e22e">azure</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">identity</span> = <span style="color:#e6db74">&#34;^1.3.0&#34;</span>

[<span style="color:#a6e22e">build</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">system</span>]
<span style="color:#a6e22e">requires</span> = [<span style="color:#e6db74">&#34;poetry-core&#34;</span>]
<span style="color:#a6e22e">build</span><span style="color:#960050;background-color:#1e0010">-</span><span style="color:#a6e22e">backend</span> = <span style="color:#e6db74">&#34;poetry.core.masonry.api&#34;</span>
</code></pre></div><p>skaffold.yaml</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">skaffold/v4beta2</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Config</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">my-app</span>
<span style="color:#f92672">build</span>:
  <span style="color:#f92672">artifacts</span>:
  - <span style="color:#f92672">image</span>: <span style="color:#ae81ff">us-central1-docker.pkg.dev/gcp-prj-123/repo/my-app</span>
    <span style="color:#f92672">docker</span>:
      <span style="color:#f92672">dockerfile</span>: <span style="color:#ae81ff">Dockerfile</span>
    <span style="color:#f92672">platforms</span>:
      - <span style="color:#e6db74">&#34;linux/amd64&#34;</span>
<span style="color:#f92672">profiles</span>:
- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">production</span>
  <span style="color:#f92672">manifests</span>:
    <span style="color:#f92672">rawYaml</span>:
    - <span style="color:#ae81ff">deploy/production/service.yaml</span>
<span style="color:#f92672">deploy</span>:
  <span style="color:#f92672">cloudrun</span>:
    <span style="color:#f92672">projectid</span>: <span style="color:#ae81ff">gcp-prj-123/repo</span>
    <span style="color:#f92672">region</span>: <span style="color:#ae81ff">us-central1</span>
</code></pre></div><p>After finally, to deploy our app to GCP Cloud Run.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">skaffold run -p production -v info
</code></pre></div><p>If you application is successfully deployed, you can see the URL of the application on the GCP console if we navigate to Cloud Run.</p>
<p>The url will look something in the format of <code>https://my-app-xxxx.a.run.app</code></p>
<p><u><b>
<p style="font-size:20pt ">
Building the application on Azure
</b></u></p>
<p align="center">
<img alt = 'png' src='/images/on_msgraph/azure-aca-flow.png'/>
</p>
<p>We will first configure our Azure environment.
1 - Local setup</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">brew update <span style="color:#f92672">&amp;&amp;</span> brew install azure-cli

az login

az extension add --name containerapp --upgrade
az provider register --namespace Microsoft.App
az provider register --namespace Microsoft.OperationalInsights
</code></pre></div><p>2- Create required resources in Azure</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Create Resource Group</span>
az group create --location centralus --resource-group myResourceGroup

<span style="color:#75715e"># Create Container App env</span>
az containerapp env create -n my-container-app-env -g myResourceGroup <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --location centralus

<span style="color:#75715e"># Create Container Registry</span>
az acr create --resource-group myResourceGroup --name myContainerRegistry --sku Basic
</code></pre></div><p>3 - Set up Azure Container Registry</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">az acr login --name myContainerRegistry

az acr update --name myContainerRegistry --admin-enabled true

<span style="color:#75715e"># This info is also on web ui</span>
az acr credential show --name myContainerRegistry
</code></pre></div><p>4 - Login in to Azure Contain Registry Locally</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker login myContainerRegistry.azurecr.io --username user --password pass-from-last-step
</code></pre></div><p>Then we can have a look on our application.
The python application will be very similar to the GCP setup. The only difference is the deployment files to Azure Container Apps.</p>
<p>Depending on the Azure VM&rsquo;s platform, instead of 80, we might want to use 8080 as the port.</p>
<p>For Dockerfile</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-dockerfile" data-lang="dockerfile"><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> python:3.11-slim</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">WORKDIR</span><span style="color:#e6db74"> /usr/src/app</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> PYTHONUNBUFFERED<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    PYTHONDONTWRITEBYTECODE<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    POETRY_VERSION<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>.7.1 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    USERNAME<span style="color:#f92672">=</span>nonroot<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> adduser $USERNAME<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">USER</span><span style="color:#e6db74"> $USERNAME</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> HOME<span style="color:#f92672">=</span>/home/$USERNAME<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">/.local/bin:</span>$PATH<span style="color:#e6db74">&#34;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> pip install pipx<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> pipx install poetry<span style="color:#f92672">==</span><span style="color:#e6db74">${</span>POETRY_VERSION<span style="color:#e6db74">}</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> ./poetry.lock pyproject.toml /usr/src/app/<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> poetry install -nv --no-root<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> creds creds<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> app .<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">CMD</span> [<span style="color:#e6db74">&#34;poetry&#34;</span>, <span style="color:#e6db74">&#34;run&#34;</span>, <span style="color:#e6db74">&#34;uvicorn&#34;</span>, <span style="color:#e6db74">&#34;main:app&#34;</span>, <span style="color:#e6db74">&#34;--host&#34;</span>, <span style="color:#e6db74">&#34;0.0.0.0&#34;</span>, <span style="color:#e6db74">&#34;--port&#34;</span>, <span style="color:#e6db74">&#34;8080&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>For skaffold.yaml, it can look something like this.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">skaffold/v2beta26</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Config</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">my-app</span>
<span style="color:#f92672">build</span>:
  <span style="color:#f92672">tagPolicy</span>:
    <span style="color:#f92672">envTemplate</span>:
      <span style="color:#f92672">template</span>: <span style="color:#e6db74">&#34;{{.IMAGE_NAME}}:lastest&#34;</span>
  <span style="color:#f92672">artifacts</span>:
  - <span style="color:#f92672">image</span>: <span style="color:#ae81ff">myContainerRegistry.azurecr.io/acr-image</span>
    <span style="color:#f92672">context</span>: <span style="color:#ae81ff">.</span>
    <span style="color:#f92672">docker</span>:
      <span style="color:#f92672">dockerfile</span>: <span style="color:#ae81ff">Dockerfile</span>
      <span style="color:#f92672">noCache</span>: <span style="color:#66d9ef">true</span>
</code></pre></div><p>To deploy our image to Azure Contain Registry</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">skaffold run --cache-artifacts<span style="color:#f92672">=</span>false
</code></pre></div><p><br /></p>
<p>Finally, to deploy our app to Azure Container Apps, we can use the below command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> az containerapp create <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --name my-app <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --resource-group myResourceGroup <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --image myContainerRegistry.azurecr.io/acr-image:latest <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --environment my-container-app-env <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --target-port <span style="color:#ae81ff">8080</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --ingress external <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --registry-server myContainerRegistry.azurecr.io <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --registry-username user <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --registry-password pass <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --query configuration.ingress.fqdn
</code></pre></div><p>If you application is successfully deployed, on the terminal where we executed the above command or on the Azure portal, we can find the URL of the application.
The application URL will look something like <code>https://my-app.xxx.centralus.azurecontainerapps.io</code></p>
<p><br /></p>
<p>If our azure container app needs to reference any secrets, there is 2 ways to do so. One way to do it is to store them as secrets in the container app, and then reference them in the application as environment variable, and the other way is to use the Azure Key Vault.</p>
<p>1 - Storing secrets in the container app and reference them in the application as environment variable.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">MY_SECRETS <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;SUPERSECRETS&#34;</span>)
</code></pre></div><p>And we can run the below command in terminal to set the env var, this will only need to execute once.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> az containerapp update --name my-app --resource-group myResourceGroup --set-env-vars <span style="color:#e6db74">&#34;SUPERSECRETS=secretref:supersecrets&#34;</span>
</code></pre></div><p>2 - Azure Key Vault</p>
<p>There are a few steps to set up on Azure to configure permission.</p>
<p>a) We first need to enable Managed Identity for the container app. To do so, go to the &ldquo;Settings&rdquo; section of our container app on the Azure Portal and select &ldquo;Identity&rdquo;.</p>
<p>In the &ldquo;System assigned&rdquo; tab, switch the &ldquo;Status&rdquo; to &ldquo;On&rdquo; to enable a system-assigned managed identity. Azure will create an identity associated with the Container App and manage its credentials.</p>
<p>Click &ldquo;Save&rdquo; at the top of the panel to apply the changes and we will obtain an object/ principal ID for our system managed identity.</p>
<p>b) Set apporiate permission on the Key Vault. Go to the &ldquo;Access policies&rdquo; section of the Key Vault and click on &ldquo;Add Access Policy&rdquo; or &ldquo;Create&rdquo;.</p>
<p>Choose the secret permissions you want to grant to the Container App (at minimum, it needs &ldquo;Get&rdquo; permission).</p>
<p>Click on &ldquo;Select principal&rdquo; and search for the system-assigned managed identity we created in the previous step. After reviewing the settings, click &ldquo;Add&rdquo; to apply the changes.</p>
<p>c) Reference the secret in the application.</p>
<p>Using the Azure SDK, we can retrieve the secret from the Key Vault.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> azure.identity <span style="color:#f92672">import</span> DefaultAzureCredential
<span style="color:#f92672">from</span> azure.keyvault.secrets <span style="color:#f92672">import</span> SecretClient
<span style="color:#f92672">from</span> os <span style="color:#f92672">import</span> getenv
<span style="color:#f92672">import</span> logging


logger <span style="color:#f92672">=</span> logging<span style="color:#f92672">.</span>getLogger(<span style="color:#e6db74">&#39;azure&#39;</span>)
logger<span style="color:#f92672">.</span>setLevel(logging<span style="color:#f92672">.</span>INFO)

RESOURCE_GRP <span style="color:#f92672">=</span> getenv(<span style="color:#e6db74">&#34;resourcegrp&#34;</span>)

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AzKeyVault</span>:
    <span style="color:#66d9ef">def</span> __init__(self) <span style="color:#f92672">-&gt;</span> None:
        self<span style="color:#f92672">.</span>credential <span style="color:#f92672">=</span> DefaultAzureCredential()
        self<span style="color:#f92672">.</span>key_vault_url <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;https://{RESOURCE_GRP}.vault.azure.net/&#34;</span>
        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> SecretClient(vault_url<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>key_vault_url, credential<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>credential, logging_enable<span style="color:#f92672">=</span>True)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_secret</span>(self, secret):
        secret_response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get_secret(secret)
        creds <span style="color:#f92672">=</span> secret_response<span style="color:#f92672">.</span>value
        <span style="color:#66d9ef">return</span> creds
</code></pre></div><p>To reference the secret in the application, we can do the below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">secrets <span style="color:#f92672">=</span> AzKeyVault()
MY_VAR <span style="color:#f92672">=</span> secrets<span style="color:#f92672">.</span>get_secret(<span style="color:#e6db74">&#34;MYSUPERSECRETS&#34;</span>)
</code></pre></div><p><u><b>
<p style="font-size:20pt ">
Adding events endpoint to our app
</b></u></p>
<p>Now, whether we decided to use cloud run or container app, we will have a url that we can use for subscribing the to the data from Microsoft Graph. As a last step, we will want to send the data we received from our MS Graph notification to our Kafka topic.</p>
<p>Below is an example simple implementation.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> fastapi <span style="color:#f92672">import</span> FastAPI, Request, Response, status
<span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Optional
<span style="color:#f92672">from</span> helpers.o365api <span style="color:#f92672">import</span> MSO365
<span style="color:#f92672">from</span> helpers.kafka <span style="color:#f92672">import</span> create_producer, produce
<span style="color:#f92672">import</span> logging


logger <span style="color:#f92672">=</span> logging<span style="color:#f92672">.</span>getLogger(__name__)

app <span style="color:#f92672">=</span> FastAPI()
producer <span style="color:#f92672">=</span> create_producer()
o365api <span style="color:#f92672">=</span> MSO365()


<span style="color:#a6e22e">@app.post</span>(<span style="color:#e6db74">&#34;/events&#34;</span>)
async <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">process_events</span>(request: Request, validationToken: Optional[str] <span style="color:#f92672">=</span> None):
    <span style="color:#66d9ef">if</span> validationToken:
        content <span style="color:#f92672">=</span> validationToken
        headers <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;text/plain&#34;</span>}
        <span style="color:#66d9ef">return</span> Response(content<span style="color:#f92672">=</span>content, media_type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/plain&#34;</span>, headers<span style="color:#f92672">=</span>headers)

    notification <span style="color:#f92672">=</span> await request<span style="color:#f92672">.</span>json()
    logging<span style="color:#f92672">.</span>info(f<span style="color:#e6db74">&#34;Notification:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">{notification}&#34;</span>)
    <span style="color:#66d9ef">try</span>:
        events <span style="color:#f92672">=</span> o365api<span style="color:#f92672">.</span>get_data(notification)
        <span style="color:#66d9ef">if</span> events:
            produce(producer, events)
        <span style="color:#66d9ef">else</span>:
            data <span style="color:#f92672">=</span> o365api<span style="color:#f92672">.</span>process(notification)
            produce(producer, data)
            logging<span style="color:#f92672">.</span>info(f<span style="color:#e6db74">&#34;Failed to get events data from graph api for {notification}&#34;</span>)

    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
        logging<span style="color:#f92672">.</span>error(f<span style="color:#e6db74">&#34;Error processing notification: {e}&#34;</span>)

    <span style="color:#66d9ef">return</span> Response(status_code<span style="color:#f92672">=</span>status<span style="color:#f92672">.</span>HTTP_202_ACCEPTED)

</code></pre></div><p>Afer we have our application set up properly, we will be able to see data from MS Graph start streaming to the kafka topic whenever our subsciprtion receives a change notification.</p>
<p align="center">
<img alt = 'png' src='/images/on_msgraph/kafka-topic.png'/>
</p>
<p>Example output of the complete json data can be found on the <a href="https://learn.microsoft.com/en-us/graph/api/calendar-list-events?view=graph-rest-1.0&amp;tabs=http#http-request">official MS Graph Documentation</a>.</p>
<p><br /></p>
<p><u><b>
<p style="font-size:20pt ">
Final Thoughts
</b></u></p>
<p>The development experiences of the 2 cloud platforms are quite similar. On their Web their, they both of metrics to monitor data volumes and performance, logs are available to debug the application. GCP will provide a deployment YAML template on the UI for user to view and edit, while Azure provides a deployment JSON that we can view on the UI.
I&rsquo;m more familiar with the GCP umbrella, so I found it easier to build the application on GCP. However, I found it interesting to build the architecture on Azure as well, especially the data source is originally from an Azure application.</p>
<p>Thank you for reading and have a nice day!</p>

    </article>


    





    
    
    
        
    




<section id="articleNext" class="section nartrow">
    <h3 class="footer-next-heading">More articles from Yu Wong</h3>
    <div class="footer-spacer"></div>
    <div class="next-articles-grid" numberOfArticles={numberOfArticles}>
        <div class="post-row">
            
                <a href="/post/20240401_jiraoauth/" class="article-link"
                 id="article-link-bigger">
                    <div>
                        <div class="image-container">
                            <img src="/images/on_jiraoauth/jira-oauth-cover.png" class="article-image" />
                        </div>
                        <div>
                            <h2 class="article-title">
                                On Jira OAuth with GCP Cloud Run
                            </h2>
                            <p class="article-excerpt">
                                Setting up Jira OAuth Application with GCP Cloud Run
                            </p>
                            <div class="article-metadata">
                                April 1, 2024 · 7 min read
                            </div>
                        </div>
                    </div>
                </a>
            
                <a href="/post/20240303_discordaibot_pt3/" class="article-link"
                >
                    <div>
                        <div class="image-container">
                            <img src="/images/on_discordAiBot/pt3_cover.png" class="article-image" />
                        </div>
                        <div>
                            <h2 class="article-title">
                                On Discord AI Chat Bot - Part 3
                            </h2>
                            <p class="article-excerpt">
                                Step by step guide to build a Discord AI Chat Bot Powered by GCP
                            </p>
                            <div class="article-metadata">
                                March 3, 2024 · 5 min read
                            </div>
                        </div>
                    </div>
                </a>
            
        </div>
    </div>
</section>

</section>


 <script src="/js/progressBar.js"></script>

        
        <div class="footer-gradient"></div>
    <div class="section narrow">
      <div class="footer-hr"></div>
      <div class="footer-container">
        <div class="footer-text">
          © 2024 Yu Wong
        </div>
        <div class="social-icon-outer">
    <div class="social-icon-container">
        
            
                
                <a href="https://fishwongy.github.io/about"><svg
class="social-icon-image"
width="14"
height="14"
viewBox="0 0 14 14"
fill="none"
xmlns="http://www.w3.org/2000/svg"
>
<path
  d="M7 0C3.14016 0 0 3.14019 0 7C0 10.8598 3.14016 14 7 14C10.8598 14 14 10.8598 14 7C14 3.14019 10.8598 0 7 0ZM11.5616 3.30136C12.3475 4.26869 12.8313 5.48966 12.8715 6.82062C11.4158 6.51926 10.0977 6.55462 8.93404 6.78278C8.72334 6.29005 8.50523 5.82062 8.28509 5.37697C9.55235 4.83104 10.6556 4.13375 11.5616 3.30136ZM10.7731 2.49993C9.87371 3.32085 8.83147 3.92867 7.76427 4.37742C6.98097 2.945 6.23154 1.86633 5.775 1.25333C6.17032 1.16911 6.57995 1.12393 7 1.12393C8.4354 1.12393 9.75151 1.64199 10.7731 2.49993ZM4.63984 1.62041C4.98459 2.06714 5.80572 3.18567 6.68777 4.77709C4.47095 5.49933 2.31992 5.62101 1.28629 5.63232C1.71713 3.83253 2.97749 2.35262 4.63984 1.62041ZM1.13006 6.7591C1.14115 6.7591 1.15187 6.75918 1.16318 6.75918C1.8774 6.75918 3.18594 6.71115 4.72646 6.43024C5.60536 6.26997 6.43879 6.05425 7.22081 5.7869C7.42439 6.19264 7.62677 6.62064 7.82301 7.06923C6.72801 7.42177 5.8046 7.92904 5.07315 8.43271C3.84658 9.27739 2.9873 10.2145 2.51811 10.7939C1.64939 9.76944 1.12392 8.4453 1.12392 7C1.12392 6.91923 1.12677 6.83913 1.13006 6.7591ZM3.328 11.5826C3.73194 11.074 4.55412 10.1482 5.74346 9.33591C6.55171 8.78383 7.3879 8.37367 8.24875 8.10445C8.74822 9.39907 9.17464 10.8295 9.42887 12.3484C8.68798 12.6862 7.86602 12.8761 7 12.8761C5.61143 12.8761 4.33474 12.3909 3.328 11.5826ZM10.4629 11.7432C10.2009 10.3483 9.8101 9.03664 9.35836 7.83793C10.4695 7.65046 11.618 7.68912 12.7975 7.95407C12.5431 9.50435 11.6805 10.8519 10.4629 11.7432Z"
  fill="#73737D"
/>
</svg></a>
                <span class="hidden">https://fishwongy.github.io/about</span>
            
        
            
                
                <a href="https://github.com/FISHWONGY"><svg
class="social-icon-image"
width="14"
height="14"
viewBox="0 0 14 14"
fill="none"
xmlns="http://www.w3.org/2000/svg"
>
<path
  fillRule="evenodd"
  clipRule="evenodd"
  d="M7 0C3.1325 0 0 3.21173 0 7.17706C0 10.3529 2.00375 13.0353 4.78625 13.9863C5.13625 14.0491 5.2675 13.8338 5.2675 13.6454C5.2675 13.4749 5.25875 12.9097 5.25875 12.3087C3.5 12.6406 3.045 11.8691 2.905 11.4653C2.82625 11.259 2.485 10.622 2.1875 10.4516C1.9425 10.317 1.5925 9.98508 2.17875 9.97611C2.73 9.96714 3.12375 10.4964 3.255 10.7118C3.885 11.7973 4.89125 11.4923 5.29375 11.3039C5.355 10.8374 5.53875 10.5234 5.74 10.3439C4.1825 10.1645 2.555 9.54549 2.555 6.80026C2.555 6.01976 2.82625 5.37382 3.2725 4.87143C3.2025 4.692 2.9575 3.95635 3.3425 2.96951C3.3425 2.96951 3.92875 2.78111 5.2675 3.70516C5.8275 3.54367 6.4225 3.46293 7.0175 3.46293C7.6125 3.46293 8.2075 3.54367 8.7675 3.70516C10.1063 2.77214 10.6925 2.96951 10.6925 2.96951C11.0775 3.95635 10.8325 4.692 10.7625 4.87143C11.2087 5.37382 11.48 6.01079 11.48 6.80026C11.48 9.55446 9.84375 10.1645 8.28625 10.3439C8.54 10.5682 8.75875 10.9988 8.75875 11.6717C8.75875 12.6316 8.75 13.4032 8.75 13.6454C8.75 13.8338 8.88125 14.0581 9.23125 13.9863C11.9963 13.0353 14 10.3439 14 7.17706C14 3.21173 10.8675 0 7 0Z"
  fill="#73737D"
/>
</svg></a>
                <span class="hidden">https://github.com/FISHWONGY</span>
            
        
            
                
                <a href="https://instagram.com/datavizofficial"><svg
class="social-icon-image"
width="13"
height="13"
viewBox="0 0 13 13"
fill="none"
xmlns="http://www.w3.org/2000/svg"
>
<path
  fillRule="evenodd"
  clipRule="evenodd"
  d="M-3.05176e-05 3.97163C-3.05176e-05 1.77803 1.77824 -0.000244141 3.97184 -0.000244141H9.0281C11.2217 -0.000244141 13 1.77802 13 3.97163V9.02788C13 11.2215 11.2217 12.9998 9.0281 12.9998H3.97184C1.77824 12.9998 -3.05176e-05 11.2215 -3.05176e-05 9.02789V3.97163ZM3.97184 1.281C2.48585 1.281 1.28122 2.48564 1.28122 3.97163V9.02789C1.28122 10.5139 2.48585 11.7185 3.97184 11.7185H9.0281C10.5141 11.7185 11.7187 10.5139 11.7187 9.02788V3.97163C11.7187 2.48564 10.5141 1.281 9.0281 1.281H3.97184Z"
  fill="#73737D"
/>
<path
  fillRule="evenodd"
  clipRule="evenodd"
  d="M3.07483 6.55115C3.07483 4.64454 4.61242 3.09253 6.51702 3.09253C8.42162 3.09253 9.95921 4.64454 9.95921 6.55115C9.95921 8.45776 8.42162 10.0098 6.51702 10.0098C4.61242 10.0098 3.07483 8.45776 3.07483 6.55115ZM6.51702 4.37378C5.32709 4.37378 4.35608 5.34508 4.35608 6.55115C4.35608 7.75722 5.32709 8.72853 6.51702 8.72853C7.70695 8.72853 8.67796 7.75722 8.67796 6.55115C8.67796 5.34508 7.70695 4.37378 6.51702 4.37378Z"
  fill="#73737D"
/>
<path
  fillRule="evenodd"
  clipRule="evenodd"
  d="M9.95062 3.87075C10.4035 3.87075 10.7706 3.50149 10.7706 3.04597C10.7706 2.59046 10.4035 2.22119 9.95062 2.22119C9.49776 2.22119 9.13065 2.59046 9.13065 3.04597C9.13065 3.50149 9.49776 3.87075 9.95062 3.87075Z"
  fill="#73737D"
/>
</svg></a>
                <span class="hidden">https://instagram.com/datavizofficial</span>
            
        
            
                
                <a href="https://www.linkedin.com/in/%F0%9F%92%BB-yu-wong-981612142/"><svg
class="social-icon-image"
width="14"
height="14"
viewBox="0 0 14 14"
fill="none"
xmlns="http://www.w3.org/2000/svg"
{...props}
>
<path
  fillRule="evenodd"
  clipRule="evenodd"
  d="M3.59615 13.125H0.871552V4.36523H3.59615V13.125ZM2.24847 3.16406C1.81878 3.16406 1.44769 3.00781 1.13519 2.69531C0.822692 2.38281 0.666443 2.01171 0.666443 1.58203C0.666443 1.15234 0.822692 0.781248 1.13519 0.468749C1.44769 0.156249 1.81878 0 2.24847 0C2.67816 0 3.04925 0.156249 3.36175 0.468749C3.67425 0.781248 3.8305 1.15234 3.8305 1.58203C3.8305 2.01171 3.67425 2.38281 3.36175 2.69531C3.04925 3.00781 2.67816 3.16406 2.24847 3.16406ZM13.7915 13.125H11.0669V8.84765C11.0669 8.14452 11.0083 7.63671 10.8911 7.32421C10.6763 6.79687 10.2563 6.5332 9.63134 6.5332C9.00634 6.5332 8.56689 6.76757 8.31298 7.23632C8.11767 7.58788 8.02001 8.10546 8.02001 8.78905V13.125H5.32471V4.36523H7.93212V5.5664H7.96142C8.15673 5.17578 8.46923 4.85351 8.89892 4.59961C9.36767 4.28711 9.91454 4.13086 10.5395 4.13086C11.8091 4.13086 12.6977 4.53125 13.2055 5.33203C13.5962 5.97656 13.7915 6.97265 13.7915 8.3203V13.125Z"
  fill="#73737D"
/>
</svg></a>
                <span class="hidden">https://www.linkedin.com/in/%F0%9F%92%BB-yu-wong-981612142/</span>
            
        
            
                
                <a href="https://twitter.com/fishwongxd"><svg
class="social-icon-image"
width="16"
height="13"
viewBox="0 0 16 13"
fill="none"
xmlns="http://www.w3.org/2000/svg"
{...props}
>
<path
  fillRule="evenodd"
  clipRule="evenodd"
  d="M14.0658 2.34438C14.7013 1.96349 15.1892 1.3604 15.419 0.641811C14.8244 0.994439 14.1658 1.25056 13.4648 1.3886C12.9034 0.7905 12.1036 0.416748 11.2185 0.416748C9.51888 0.416748 8.14096 1.79461 8.14096 3.49411C8.14096 3.7353 8.16822 3.97019 8.22068 4.19542C5.66301 4.06708 3.39543 2.84191 1.8776 0.980064C1.6127 1.43458 1.46094 1.96322 1.46094 2.52719C1.46094 3.59485 2.00428 4.5368 2.83003 5.08865C2.32553 5.07268 1.85104 4.93425 1.43608 4.70376C1.43586 4.71659 1.43586 4.72949 1.43586 4.74244C1.43586 6.23349 2.49666 7.47732 3.90448 7.75999C3.64622 7.83033 3.37436 7.86792 3.09366 7.86792C2.89537 7.86792 2.70257 7.84866 2.51471 7.81272C2.90629 9.03537 4.0428 9.92509 5.38945 9.94994C4.33623 10.7753 3.00928 11.2673 1.56749 11.2673C1.31911 11.2673 1.07413 11.2528 0.833374 11.2243C2.19527 12.0975 3.81291 12.6069 5.55081 12.6069C11.2113 12.6069 14.3067 7.91763 14.3067 3.85096C14.3067 3.71753 14.3037 3.5848 14.2978 3.45285C14.899 3.01896 15.4208 2.47694 15.8334 1.8598C15.2815 2.10456 14.6884 2.26998 14.0658 2.34438Z"
  fill="#73737D"
/>
</svg></a>
                <span class="hidden">https://twitter.com/fishwongxd</span>
            
        
    </div>
</div>
    </div>
</div>

    </div>

    
    <script src="/js/prism.js"></script>
</body>

</html>